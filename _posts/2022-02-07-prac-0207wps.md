---
layout: post
title: Prac#1月比赛wp
author: Rechn0
date: 2022-02-07 14:30 +0800
last_modified_at: 2022-02-07 14:30 +0800
tags: [wp, web, crypto]
categories: [ctf, wp]
toc:  true
math: true
---

假期摸鱼了一些练习赛，记录一下解题思路与复现情况

# **HgameCTF2022**

---

# **DiceCTF2022**

## crypto#babyrsa

Problem: 给出e,c,n其中e与 \\\( \phi(n) \\\) 不互素

**思路：**

n规模较小，暴力分解后检验发现 \\\( gcd(e, \phi(n) )=e \\\)

经典AMM开根crt合并，筛选解空间得到flag

对不起，我选择f.roots()

```
from babyrsa import e,cipher,p,q
# factor N before solving
def nth_solve(n,c,p):
    R.<x>=PolynomialRing(GF(p))
    f=x^n-c
    f=f.monic()
    return f.roots()

m1=nth_solve(e,cipher,p)
m2=nth_solve(e,cipher,q)
for i in m1:
    for j in m2:
        m=crt([i[0],j[0]],[p,q])
        m=long_to_bytes(m)
        if b'dice{' in m:exit(print(m))
```

dice{cado-and-sage-say-hello}

## crypto#commitment-issues

Problem: 魔法签名，给出模n下(m^e+key)与(key^5)用于签名认证

赛时思路：

5次幂好小，可以开根(？)

(甚至虚心请问了队里的密码学师傅)

**思路：**

## crypto#rejected

Problem: 随机数产生系统，可以设定模数

赛时思路：

从前基本没有分析过在线的题目，比较没有经验。

分析发现系统底层是64bitLFSR，每次会取32bit产生随机数，系统不断迭代直到产生小于截断界限的随机数。然而，我们能够得到的回显只有产生该随机数使用的轮数。

分析发现系统截断会由指定的模数产生，故构造模数N可以影响到截断的效果。赛时考虑到N=pow(2,30)+1，此时cutoff=pow(2,31)+2，可以区分最高位为0/1的状态？

一方面是想的不够深入，另一方面通过这些离散bit也不太会恢复LFSR的前继状态。随缘复现，原地留坑

**思路：**

## crypto#correlated

---